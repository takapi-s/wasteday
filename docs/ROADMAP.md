# Wasteday ロードマップ（初版）

## 目的
- **可視化**: PC上の「浪費時間」を直感的に可視化し、日次/週次/月次で改善のきっかけを提供する。
- **ローカルファースト**: 中核機能はオフラインで完結。データはローカルSQLiteに保存。
- **拡張性**: ブラウザ拡張や将来のクラウド同期を段階的に追加できる構成。

## 現状（2025-Q4）
- デスクトップ（Tauri + React + TypeScript）で5秒ごとに前面アプリとアイドル秒をサンプリング。
- ローカルSQLiteに `sessions` / `waste_categories` / `browsing_sessions` / `domains` を保存。
- Chrome拡張からのドメイン別滞在時間をHTTP取り込み（`localhost:5606`）。
- ダッシュボード、カテゴリ管理、設定、アップデータ（GitHub Releases）を実装済み。

## マイルストーン

### v1.1 ローカル体験の磨き込み
- ダッシュボードの見やすさ改善（凡例、ツールチップ、範囲選択）
- 週次/月次の比較指標の一貫化（前週/前月比の表示整理）
- カテゴリ管理の一括操作（複数選択→有効/無効、ラベル変更）
- データのエクスポート（CSV/JSON、日/週/月単位）
- パフォーマンス最適化（初期ロード・再計算のキャッシュ強化）

### v1.2 ブラウジング追跡の拡充
- ドメイン→URLルールの粒度向上（サブドメイン/パス単位の分類）
- 例外ルール（特定URLを常に非浪費扱い等）の導入
- 拡張ポップアップのUI改善（直近トップドメイン、手動一時停止/再開）
- Edge/Firefox 互換検討（API差分の調査と最小実装）

### v1.3 ユーザー体験の向上
- 初回起動のオンボーディング（カテゴリ初期セット/チュートリアル）
- 通知体験の改善（本日閾値超過時の軽量通知）
- 統合ダッシュボードのタブUI強化（データソース説明、切替ショートカット）

### v2.0（計画）クラウド同期（サブスク）
- マルチデバイス同期（衝突解決: サーバー優先/クライアント優先/マージ）
- 差分アップロード/ダウンロード、圧縮、再送制御
- プライバシー保護（E2E暗号化の検討、匿名化オプション）
- オンラインバックアップ、端末間比較、高度な分析

## 非目標（当面扱わない）
- キーロガー等の細粒度入力の収集（プライバシー配慮のため非対応）
- フルリモート依存の設計（ローカルファースト方針に反する）
- 過度に侵襲的な監視（スクリーンショット/録画など）

## リスクと対策
- パフォーマンス劣化: 集計のバケット化、メモ化、WebWorker活用
- 誤分類の蓄積: 未登録識別子の検出UI強化、バルク編集、将来的な学習的提案
- 拡張との接続不安定: ヘルスチェック、再接続、バックオフ
- Windows依存の拡大: macOS/Linux 対応層の抽象化を維持

## KPI（ローカル版）
- ダッシュボード初期描画 < 1.5s（平均）
- 30日分データで主要遷移 60fps 目標
- 誤分類修正に要する操作回数の削減（v1.1で20%改善）

## データとプライバシー方針
- 既定はローカル保存のみ。外部送信なし。
- 将来のクラウド機能は明示的同意と分離設定を前提。

## 参照（実装）
- ローカルDB/コマンド: `apps/desktop/src-tauri/src/lib.rs`
- アップデート: `apps/desktop/src-tauri/tauri.conf.json`, `useUpdater`, `UpdateNotification`
- 集計/フック: `apps/desktop/src/hooks/**`
- 拡張HTTP取り込み: `apps/desktop/src-tauri/src/lib.rs`（tiny_http）, `apps/chrome-extension/**`

## スケジュール（目安）
- v1.1: 4〜6週間
- v1.2: 4〜6週間
- v1.3: 4〜6週間
- v2.0（クラウド）: 要設計/PoC（3ヶ月〜）

## コミュニティと貢献
- Issue/PR を歓迎。小さな変更からお願いします。
- 変更提案はスクリーンショット/動画や計測値を添付いただけると助かります。
